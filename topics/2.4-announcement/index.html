<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Q1mi">
        <link rel="canonical" href="https://q1mi.github.io/Django-REST-framework-documentation/topics/2.4-announcement/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Django REST framework 2.4 - Django REST framework中文站点</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../..">Django REST framework中文站点</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="../..">主页</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">教程 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../tutorial/quickstart_zh/">Quickstart</a>
</li>
                                    
<li >
    <a href="../../tutorial/1-serialization_zh/">1 - Serialization</a>
</li>
                                    
<li >
    <a href="../../tutorial/2-requests-and-responses_zh/">2 - Requests and responses</a>
</li>
                                    
<li >
    <a href="../../tutorial/3-class-based-views_zh/">3 - Class based views</a>
</li>
                                    
<li >
    <a href="../../tutorial/4-authentication-and-permissions_zh/">4 - Authentication and permissions</a>
</li>
                                    
<li >
    <a href="../../tutorial/5-relationships-and-hyperlinked-apis_zh/">5 - Relationships and hyperlinked APIs</a>
</li>
                                    
<li >
    <a href="../../tutorial/6-viewsets-and-routers_zh/">6 - Viewsets and routers</a>
</li>
                                    
<li >
    <a href="../../tutorial/7-schemas-and-client-libraries_zh/">7 - Schemas and client libraries</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">API指南 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../api-guide/requests_zh/">Requests</a>
</li>
                                    
<li >
    <a href="../../api-guide/responses_zh/">Responses</a>
</li>
                                    
<li >
    <a href="../../api-guide/views_zh/">Views</a>
</li>
                                    
<li >
    <a href="../../api-guide/generic-views_zh/">Generic views</a>
</li>
                                    
<li >
    <a href="../../api-guide/viewsets_zh/">Viewsets</a>
</li>
                                    
<li >
    <a href="../../api-guide/routers_zh/">Routers</a>
</li>
                                    
<li >
    <a href="../../api-guide/parsers_zh/">Parsers</a>
</li>
                                    
<li >
    <a href="../../api-guide/renderers_zh/">Renderers</a>
</li>
                                    
<li >
    <a href="../../api-guide/serializers_zh/">Serializers</a>
</li>
                                    
<li >
    <a href="../../api-guide/fields_zh/">Serializer fields</a>
</li>
                                    
<li >
    <a href="../../api-guide/relations/">Serializer relations</a>
</li>
                                    
<li >
    <a href="../../api-guide/validators/">Validators</a>
</li>
                                    
<li >
    <a href="../../api-guide/authentication_zh/">Authentication</a>
</li>
                                    
<li >
    <a href="../../api-guide/permissions_zh/">Permissions</a>
</li>
                                    
<li >
    <a href="../../api-guide/throttling/">Throttling</a>
</li>
                                    
<li >
    <a href="../../api-guide/filtering_zh/">Filtering</a>
</li>
                                    
<li >
    <a href="../../api-guide/pagination/">Pagination</a>
</li>
                                    
<li >
    <a href="../../api-guide/versioning_zh/">Versioning</a>
</li>
                                    
<li >
    <a href="../../api-guide/content-negotiation/">Content negotiation</a>
</li>
                                    
<li >
    <a href="../../api-guide/metadata/">Metadata</a>
</li>
                                    
<li >
    <a href="../../api-guide/schemas/">Schemas</a>
</li>
                                    
<li >
    <a href="../../api-guide/format-suffixes/">Format suffixes</a>
</li>
                                    
<li >
    <a href="../../api-guide/reverse/">Returning URLs</a>
</li>
                                    
<li >
    <a href="../../api-guide/exceptions/">Exceptions</a>
</li>
                                    
<li >
    <a href="../../api-guide/status-codes/">Status codes</a>
</li>
                                    
<li >
    <a href="../../api-guide/testing/">Testing</a>
</li>
                                    
<li >
    <a href="../../api-guide/settings/">Settings</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">主题 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../documenting-your-api/">Documenting your API</a>
</li>
                                    
<li >
    <a href="../api-clients/">API Clients</a>
</li>
                                    
<li >
    <a href="../internationalization/">Internationalization</a>
</li>
                                    
<li >
    <a href="../ajax-csrf-cors_zh/">AJAX, CSRF & CORS</a>
</li>
                                    
<li >
    <a href="../html-and-forms/">HTML & Forms</a>
</li>
                                    
<li >
    <a href="../browser-enhancements/">Browser Enhancements</a>
</li>
                                    
<li >
    <a href="../browsable-api/">The Browsable API</a>
</li>
                                    
<li >
    <a href="../rest-hypermedia-hateoas/">REST, Hypermedia & HATEOAS</a>
</li>
                                    
<li >
    <a href="../third-party-packages/">Third Party Packages</a>
</li>
                                    
<li >
    <a href="../tutorials-and-resources/">Tutorials and Resources</a>
</li>
                                    
<li >
    <a href="../contributing/">Contributing to REST framework</a>
</li>
                                    
<li >
    <a href="../project-management/">Project management</a>
</li>
                                    
<li >
    <a href="../3.0-announcement/">3.0 Announcement</a>
</li>
                                    
<li >
    <a href="../3.1-announcement/">3.1 Announcement</a>
</li>
                                    
<li >
    <a href="../3.2-announcement/">3.2 Announcement</a>
</li>
                                    
<li >
    <a href="../3.3-announcement/">3.3 Announcement</a>
</li>
                                    
<li >
    <a href="../3.4-announcement/">3.4 Announcement</a>
</li>
                                    
<li >
    <a href="../3.5-announcement/">3.5 Announcement</a>
</li>
                                    
<li >
    <a href="../kickstarter-announcement/">Kickstarter Announcement</a>
</li>
                                    
<li >
    <a href="../mozilla-grant/">Mozilla Grant</a>
</li>
                                    
<li >
    <a href="../funding/">Funding</a>
</li>
                                    
<li >
    <a href="../release-notes/">Release Notes</a>
</li>
                                    
<li >
    <a href="../jobs/">Jobs</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li>
                                <a href="https://github.com/Q1mi/Django-REST-framework-documentation/edit/master/docs/topics/2.4-announcement.md"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#django-rest-framework-24">Django REST framework 2.4</a></li>
            <li><a href="#version-requirements">Version requirements</a></li>
            <li><a href="#django-17-support">Django 1.7 support</a></li>
            <li><a href="#deprecation-of-model-view-attribute">Deprecation of .model view attribute</a></li>
            <li><a href="#updated-test-runner">Updated test runner</a></li>
            <li><a href="#improved-viewset-routing">Improved viewset routing</a></li>
            <li><a href="#throttle-behavior">Throttle behavior</a></li>
            <li><a href="#other-features">Other features</a></li>
            <li><a href="#deprecations">Deprecations</a></li>
            <li><a href="#labels-and-milestones">Labels and milestones</a></li>
            <li><a href="#next-steps">Next steps</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="django-rest-framework-24"><a class="toclink" href="#django-rest-framework-24">Django REST framework 2.4</a></h1>
<p>The 2.4 release is largely an intermediate step, tying up some outstanding issues prior to the 3.x series.</p>
<h2 id="version-requirements"><a class="toclink" href="#version-requirements">Version requirements</a></h2>
<p>Support for Django 1.3 has been dropped.
The lowest supported version of Django is now 1.4.2.</p>
<p>The current plan is for REST framework to remain in lockstep with <a href="https://docs.djangoproject.com/en/stable/internals/release-process/#long-term-support-lts-releases">Django's long-term support policy</a>.</p>
<h2 id="django-17-support"><a class="toclink" href="#django-17-support">Django 1.7 support</a></h2>
<p>The optional authtoken application now includes support for <em>both</em> Django 1.7 schema migrations, <em>and</em> for old-style <code>south</code> migrations.</p>
<p><strong>If you are using authtoken, and you want to continue using <code>south</code>, you must upgrade your <code>south</code> package to version 1.0.</strong></p>
<h2 id="deprecation-of-model-view-attribute"><a class="toclink" href="#deprecation-of-model-view-attribute">Deprecation of <code>.model</code> view attribute</a></h2>
<p>The <code>.model</code> attribute on view classes is an optional shortcut for either or both of <code>.serializer_class</code> and <code>.queryset</code>. Its usage results in more implicit, less obvious behavior.</p>
<p>The documentation has previously stated that usage of the more explicit style is prefered, and we're now taking that one step further and deprecating the usage of the <code>.model</code> shortcut.</p>
<p>Doing so will mean that there are cases of API code where you'll now need to include a serializer class where you previously were just using the <code>.model</code> shortcut. However we firmly believe that it is the right trade-off to make.</p>
<p>Removing the shortcut takes away an unnecessary layer of abstraction, and makes your codebase more explicit without any significant extra complexity. It also results in better consistency, as there's now only one way to set the serializer class and queryset attributes for the view, instead of two.</p>
<p>The <code>DEFAULT_MODEL_SERIALIZER_CLASS</code> API setting is now also deprecated.</p>
<h2 id="updated-test-runner"><a class="toclink" href="#updated-test-runner">Updated test runner</a></h2>
<p>We now have a new test runner for developing against the project,, that uses the excellent <a href="http://pytest.org">py.test</a> library.</p>
<p>To use it make sure you have first installed the test requirements.</p>
<pre><code>pip install -r requirements-test.txt
</code></pre>
<p>Then run the <code>runtests.py</code> script.</p>
<pre><code>./runtests.py
</code></pre>
<p>The new test runner also includes <a href="https://flake8.readthedocs.io">flake8</a> code linting, which should help keep our coding style consistent.</p>
<h4 id="test-runner-flags"><a class="toclink" href="#test-runner-flags">Test runner flags</a></h4>
<p>Run using a more concise output style.</p>
<pre><code>./runtests -q
</code></pre>
<p>Run the tests using a more concise output style, no coverage, no flake8.</p>
<pre><code>./runtests --fast
</code></pre>
<p>Don't run the flake8 code linting.</p>
<pre><code>./runtests --nolint
</code></pre>
<p>Only run the flake8 code linting, don't run the tests.</p>
<pre><code>./runtests --lintonly
</code></pre>
<p>Run the tests for a given test case.</p>
<pre><code>./runtests MyTestCase
</code></pre>
<p>Run the tests for a given test method.</p>
<pre><code>./runtests MyTestCase.test_this_method
</code></pre>
<p>Shorter form to run the tests for a given test method.</p>
<pre><code>./runtests test_this_method
</code></pre>
<p>Note: The test case and test method matching is fuzzy and will sometimes run other tests that contain a partial string match to the given  command line input.</p>
<h2 id="improved-viewset-routing"><a class="toclink" href="#improved-viewset-routing">Improved viewset routing</a></h2>
<p>The <code>@action</code> and <code>@link</code> decorators were inflexible in that they only allowed additional routes to be added against instance style URLs, not against list style URLs.</p>
<p>The <code>@action</code> and <code>@link</code> decorators have now been moved to pending deprecation, and the <code>@list_route</code> and <code>@detail_route</code> decorators have been introduced.</p>
<p>Here's an example of using the new decorators. Firstly we have a detail-type route named "set_password" that acts on a single instance, and takes a <code>pk</code> argument in the URL. Secondly we have a list-type route named "recent_users" that acts on a queryset, and does not take any arguments in the URL.</p>
<pre><code>class UserViewSet(viewsets.ModelViewSet):
    """
    A viewset that provides the standard actions
    """
    queryset = User.objects.all()
    serializer_class = UserSerializer

    @detail_route(methods=['post'])
    def set_password(self, request, pk=None):
        user = self.get_object()
        serializer = PasswordSerializer(data=request.DATA)
        if serializer.is_valid():
            user.set_password(serializer.data['password'])
            user.save()
            return Response({'status': 'password set'})
        else:
            return Response(serializer.errors,
                            status=status.HTTP_400_BAD_REQUEST)

    @list_route()
    def recent_users(self, request):
        recent_users = User.objects.all().order('-last_login')
        page = self.paginate_queryset(recent_users)
        serializer = self.get_pagination_serializer(page)
        return Response(serializer.data)
</code></pre>
<p>For more details, see the <a href="../../api-guide/viewsets/">viewsets documentation</a>.</p>
<h2 id="throttle-behavior"><a class="toclink" href="#throttle-behavior">Throttle behavior</a></h2>
<p>There's one bugfix in 2.4 that's worth calling out, as it will <em>invalidate existing throttle caches</em> when you upgrade.</p>
<p>We've now fixed a typo on the <code>cache_format</code> attribute. Previously this was named <code>"throtte_%(scope)s_%(ident)s"</code>, it is now <code>"throttle_%(scope)s_%(ident)s"</code>.</p>
<p>If you're concerned about the invalidation you have two options.</p>
<ul>
<li>Manually pre-populate your cache with the fixed version.</li>
<li>Set the <code>cache_format</code> attribute on your throttle class in order to retain the previous incorrect spelling.</li>
</ul>
<h2 id="other-features"><a class="toclink" href="#other-features">Other features</a></h2>
<p>There are also a number of other features and bugfixes as <a href="release-notes#240">listed in the release notes</a>. In particular these include:</p>
<p><a href="../api-guide/settings#view-names-and-descriptions">Customizable view name and description functions</a> for use with the browsable API, by using the <code>VIEW_NAME_FUNCTION</code> and <code>VIEW_DESCRIPTION_FUNCTION</code> settings.</p>
<p>Smarter <a href="../api-guide/throttling#how-clients-are-identified">client IP identification for throttling</a>, with the addition of the <code>NUM_PROXIES</code> setting.</p>
<p>Added the standardized <code>Retry-After</code> header to throttled responses, as per <a href="http://tools.ietf.org/html/rfc6585">RFC 6585</a>. This should now be used in preference to the custom <code>X-Throttle-Wait-Seconds</code> header which will be fully deprecated in 3.0.</p>
<h2 id="deprecations"><a class="toclink" href="#deprecations">Deprecations</a></h2>
<p>All API changes in 2.3 that previously raised <code>PendingDeprecationWarning</code> will now raise a <code>DeprecationWarning</code>, which is loud by default.</p>
<p>All API changes in 2.3 that previously raised <code>DeprecationWarning</code> have now been removed entirely.</p>
<p>Furter details on these deprecations is available in the <a href="2.3-announcement">2.3 announcement</a>.</p>
<h2 id="labels-and-milestones"><a class="toclink" href="#labels-and-milestones">Labels and milestones</a></h2>
<p>Although not strictly part of the 2.4 release it's also worth noting here that we've been working hard towards improving our triage process.</p>
<p>The <a href="https://github.com/tomchristie/django-rest-framework/issues">labels that we use in GitHub</a> have been cleaned up, and all existing tickets triaged. Any given ticket should have one and only one label, indicating its current state.</p>
<p>We've also <a href="https://github.com/tomchristie/django-rest-framework/milestones">started using milestones</a> in order to track tickets against particular releases.</p>
<hr />
<p><img alt="Labels and milestones" src="../../img/labels-and-milestones.png" /></p>
<p><strong>Above</strong>: <em>Overview of our current use of labels and milestones in GitHub.</em></p>
<hr />
<p>We hope both of these changes will help make the management process more clear and obvious and help keep tickets well-organised and relevant.</p>
<h2 id="next-steps"><a class="toclink" href="#next-steps">Next steps</a></h2>
<p>The next planned release will be 3.0, featuring an improved and simplified serializer implementation.</p>
<p>Once again, many thanks to all the generous <a href="kickstarter-announcement#sponsors">backers and sponsors</a> who've helped make this possible!</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
