<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Q1mi">
        <link rel="canonical" href="https://q1mi.github.io/Django-REST-framework-documentation/topics/2.2-announcement/">
        <link rel="shortcut icon" href="../../img/favicon.ico">
        <title>Django REST framework 2.2 - Django REST framework中文站点</title>
        <link href="../../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../../css/font-awesome.min.css" rel="stylesheet">
        <link href="../../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

        <script src="../../js/jquery-1.10.2.min.js" defer></script>
        <script src="../../js/bootstrap-3.0.3.min.js" defer></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
            <div class="container">

                <!-- Collapsed navigation -->
                <div class="navbar-header">
                    <!-- Expander button -->
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="../..">Django REST framework中文站点</a>
                </div>

                <!-- Expanded navigation -->
                <div class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li >
                                <a href="../..">主页</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">教程 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../tutorial/quickstart_zh/">Quickstart</a>
</li>
                                    
<li >
    <a href="../../tutorial/1-serialization_zh/">1 - Serialization</a>
</li>
                                    
<li >
    <a href="../../tutorial/2-requests-and-responses_zh/">2 - Requests and responses</a>
</li>
                                    
<li >
    <a href="../../tutorial/3-class-based-views_zh/">3 - Class based views</a>
</li>
                                    
<li >
    <a href="../../tutorial/4-authentication-and-permissions_zh/">4 - Authentication and permissions</a>
</li>
                                    
<li >
    <a href="../../tutorial/5-relationships-and-hyperlinked-apis_zh/">5 - Relationships and hyperlinked APIs</a>
</li>
                                    
<li >
    <a href="../../tutorial/6-viewsets-and-routers_zh/">6 - Viewsets and routers</a>
</li>
                                    
<li >
    <a href="../../tutorial/7-schemas-and-client-libraries_zh/">7 - Schemas and client libraries</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">API指南 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../../api-guide/requests_zh/">Requests</a>
</li>
                                    
<li >
    <a href="../../api-guide/responses_zh/">Responses</a>
</li>
                                    
<li >
    <a href="../../api-guide/views_zh/">Views</a>
</li>
                                    
<li >
    <a href="../../api-guide/generic-views_zh/">Generic views</a>
</li>
                                    
<li >
    <a href="../../api-guide/viewsets_zh/">Viewsets</a>
</li>
                                    
<li >
    <a href="../../api-guide/routers_zh/">Routers</a>
</li>
                                    
<li >
    <a href="../../api-guide/parsers_zh/">Parsers</a>
</li>
                                    
<li >
    <a href="../../api-guide/renderers_zh/">Renderers</a>
</li>
                                    
<li >
    <a href="../../api-guide/serializers_zh/">Serializers</a>
</li>
                                    
<li >
    <a href="../../api-guide/fields_zh/">Serializer fields</a>
</li>
                                    
<li >
    <a href="../../api-guide/relations/">Serializer relations</a>
</li>
                                    
<li >
    <a href="../../api-guide/validators/">Validators</a>
</li>
                                    
<li >
    <a href="../../api-guide/authentication_zh/">Authentication</a>
</li>
                                    
<li >
    <a href="../../api-guide/permissions_zh/">Permissions</a>
</li>
                                    
<li >
    <a href="../../api-guide/throttling/">Throttling</a>
</li>
                                    
<li >
    <a href="../../api-guide/filtering_zh/">Filtering</a>
</li>
                                    
<li >
    <a href="../../api-guide/pagination/">Pagination</a>
</li>
                                    
<li >
    <a href="../../api-guide/versioning_zh/">Versioning</a>
</li>
                                    
<li >
    <a href="../../api-guide/content-negotiation/">Content negotiation</a>
</li>
                                    
<li >
    <a href="../../api-guide/metadata/">Metadata</a>
</li>
                                    
<li >
    <a href="../../api-guide/schemas/">Schemas</a>
</li>
                                    
<li >
    <a href="../../api-guide/format-suffixes/">Format suffixes</a>
</li>
                                    
<li >
    <a href="../../api-guide/reverse/">Returning URLs</a>
</li>
                                    
<li >
    <a href="../../api-guide/exceptions/">Exceptions</a>
</li>
                                    
<li >
    <a href="../../api-guide/status-codes/">Status codes</a>
</li>
                                    
<li >
    <a href="../../api-guide/testing/">Testing</a>
</li>
                                    
<li >
    <a href="../../api-guide/settings/">Settings</a>
</li>
                                </ul>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown">主题 <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li >
    <a href="../documenting-your-api/">Documenting your API</a>
</li>
                                    
<li >
    <a href="../api-clients/">API Clients</a>
</li>
                                    
<li >
    <a href="../internationalization/">Internationalization</a>
</li>
                                    
<li >
    <a href="../ajax-csrf-cors_zh/">AJAX, CSRF & CORS</a>
</li>
                                    
<li >
    <a href="../html-and-forms/">HTML & Forms</a>
</li>
                                    
<li >
    <a href="../browser-enhancements/">Browser Enhancements</a>
</li>
                                    
<li >
    <a href="../browsable-api/">The Browsable API</a>
</li>
                                    
<li >
    <a href="../rest-hypermedia-hateoas/">REST, Hypermedia & HATEOAS</a>
</li>
                                    
<li >
    <a href="../third-party-packages/">Third Party Packages</a>
</li>
                                    
<li >
    <a href="../tutorials-and-resources/">Tutorials and Resources</a>
</li>
                                    
<li >
    <a href="../contributing/">Contributing to REST framework</a>
</li>
                                    
<li >
    <a href="../project-management/">Project management</a>
</li>
                                    
<li >
    <a href="../3.0-announcement/">3.0 Announcement</a>
</li>
                                    
<li >
    <a href="../3.1-announcement/">3.1 Announcement</a>
</li>
                                    
<li >
    <a href="../3.2-announcement/">3.2 Announcement</a>
</li>
                                    
<li >
    <a href="../3.3-announcement/">3.3 Announcement</a>
</li>
                                    
<li >
    <a href="../3.4-announcement/">3.4 Announcement</a>
</li>
                                    
<li >
    <a href="../3.5-announcement/">3.5 Announcement</a>
</li>
                                    
<li >
    <a href="../kickstarter-announcement/">Kickstarter Announcement</a>
</li>
                                    
<li >
    <a href="../mozilla-grant/">Mozilla Grant</a>
</li>
                                    
<li >
    <a href="../funding/">Funding</a>
</li>
                                    
<li >
    <a href="../release-notes/">Release Notes</a>
</li>
                                    
<li >
    <a href="../jobs/">Jobs</a>
</li>
                                </ul>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav navbar-right">
                        <li>
                            <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                                <i class="fa fa-search"></i> Search
                            </a>
                        </li>
                            <li>
                                <a href="https://github.com/Q1mi/Django-REST-framework-documentation/edit/master/docs/topics/2.2-announcement.md"><i class="fa fa-github"></i> Edit on GitHub</a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#django-rest-framework-22">Django REST framework 2.2</a></li>
            <li><a href="#python-3-support">Python 3 support</a></li>
            <li><a href="#deprecation-policy">Deprecation policy</a></li>
            <li><a href="#community">Community</a></li>
            <li><a href="#api-changes">API changes</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="django-rest-framework-22"><a class="toclink" href="#django-rest-framework-22">Django REST framework 2.2</a></h1>
<p>The 2.2 release represents an important point for REST framework, with the addition of Python 3 support, and the introduction of an official deprecation policy.</p>
<h2 id="python-3-support"><a class="toclink" href="#python-3-support">Python 3 support</a></h2>
<p>Thanks to some fantastic work from <a href="https://github.com/xordoquy">Xavier Ordoquy</a>, Django REST framework 2.2 now supports Python 3.  You'll need to be running Django 1.5, and it's worth keeping in mind that Django's Python 3 support is currently <a href="https://docs.djangoproject.com/en/stable/faq/install/#can-i-use-django-with-python-3">considered experimental</a>.</p>
<p>Django 1.6's Python 3 support is expected to be officially labeled as 'production-ready'.</p>
<p>If you want to start ensuring that your own projects are Python 3 ready, we can highly recommend Django's <a href="https://docs.djangoproject.com/en/stable/topics/python3/">Porting to Python 3</a> documentation.</p>
<p>Django REST framework's Python 2.6 support now requires 2.6.5 or above, in line with <a href="https://docs.djangoproject.com/en/stable/releases/1.5/#python-compatibility">Django 1.5's Python compatibility</a>.</p>
<h2 id="deprecation-policy"><a class="toclink" href="#deprecation-policy">Deprecation policy</a></h2>
<p>We've now introduced an official deprecation policy, which is in line with <a href="https://docs.djangoproject.com/en/stable/internals/release-process/#internal-release-deprecation-policy">Django's deprecation policy</a>.  This policy will make it easy for you to continue to track the latest, greatest version of REST framework.</p>
<p>The timeline for deprecation works as follows:</p>
<ul>
<li>
<p>Version 2.2 introduces some API changes as detailed in the release notes.  It remains fully backwards compatible with 2.1, but will raise <code>PendingDeprecationWarning</code> warnings if you use bits of API that are due to be deprecated.  These warnings are silent by default, but can be explicitly enabled when you're ready to start migrating any required changes.  For example if you start running your tests using <code>python -Wd manage.py test</code>, you'll be warned of any API changes you need to make.</p>
</li>
<li>
<p>Version 2.3 will escalate these warnings to <code>DeprecationWarning</code>, which is loud by default.</p>
</li>
<li>
<p>Version 2.4 will remove the deprecated bits of API entirely.</p>
</li>
</ul>
<p>Note that in line with Django's policy, any parts of the framework not mentioned in the documentation should generally be considered private API, and may be subject to change.</p>
<h2 id="community"><a class="toclink" href="#community">Community</a></h2>
<p>As of the 2.2 merge, we've also hit an impressive milestone.  The number of committers listed in <a href="http://www.django-rest-framework.org/topics/credits">the credits</a>, is now at over <strong>one hundred individuals</strong>.  Each name on that list represents at least one merged pull request, however large or small.</p>
<p>Our <a href="https://groups.google.com/forum/?fromgroups#!forum/django-rest-framework">mailing list</a> and #restframework IRC channel are also very active, and we've got a really impressive rate of development both on REST framework itself, and on third party packages such as the great <a href="https://github.com/marcgibbons/django-rest-framework-docs">django-rest-framework-docs</a> package from <a href="https://github.com/marcgibbons/">Marc Gibbons</a>.</p>
<hr />
<h2 id="api-changes"><a class="toclink" href="#api-changes">API changes</a></h2>
<p>The 2.2 release makes a few changes to the API, in order to make it more consistent, simple, and easier to use.</p>
<h3 id="cleaner-to-many-related-fields"><a class="toclink" href="#cleaner-to-many-related-fields">Cleaner to-many related fields</a></h3>
<p>The <code>ManyRelatedField()</code> style is being deprecated in favor of a new <code>RelatedField(many=True)</code> syntax.</p>
<p>For example, if a user is associated with multiple questions, which we want to represent using a primary key relationship, we might use something like the following:</p>
<pre><code>class UserSerializer(serializers.HyperlinkedModelSerializer):
    questions = serializers.PrimaryKeyRelatedField(many=True)

    class Meta:
        fields = ('username', 'questions')
</code></pre>
<p>The new syntax is cleaner and more obvious, and the change will also make the documentation cleaner, simplify the internal API, and make writing custom relational fields easier.</p>
<p>The change also applies to serializers.  If you have a nested serializer, you should start using <code>many=True</code> for to-many relationships.  For example, a serializer representation of an Album that can contain many Tracks might look something like this:</p>
<pre><code>class TrackSerializer(serializer.ModelSerializer):
    class Meta:
        model = Track
        fields = ('name', 'duration')

class AlbumSerializer(serializer.ModelSerializer):
    tracks = TrackSerializer(many=True)

    class Meta:
        model = Album
        fields = ('album_name', 'artist', 'tracks')
</code></pre>
<p>Additionally, the change also applies when serializing or deserializing data.  For example to serialize a queryset of models you should now use the <code>many=True</code> flag.</p>
<pre><code>serializer = SnippetSerializer(Snippet.objects.all(), many=True)
serializer.data
</code></pre>
<p>This more explicit behavior on serializing and deserializing data <a href="https://github.com/tomchristie/django-rest-framework/issues/564">makes integration with non-ORM backends such as MongoDB easier</a>, as instances to be serialized can include the <code>__iter__</code> method, without incorrectly triggering list-based serialization, or requiring workarounds.</p>
<p>The implicit to-many behavior on serializers, and the <code>ManyRelatedField</code> style classes will continue to function, but will raise a <code>PendingDeprecationWarning</code>, which can be made visible using the <code>-Wd</code> flag.</p>
<p><strong>Note</strong>: If you need to forcibly turn off the implicit "<code>many=True</code> for <code>__iter__</code> objects" behavior, you can now do so by specifying <code>many=False</code>.  This will become the default (instead of the current default of <code>None</code>) once the deprecation of the implicit behavior is finalised in version 2.4.</p>
<h3 id="cleaner-optional-relationships"><a class="toclink" href="#cleaner-optional-relationships">Cleaner optional relationships</a></h3>
<p>Serializer relationships for nullable Foreign Keys will change from using the current <code>null=True</code> flag, to instead using <code>required=False</code>.</p>
<p>For example, is a user account has an optional foreign key to a company, that you want to express using a hyperlink, you might use the following field in a <code>Serializer</code> class:</p>
<pre><code>current_company = serializers.HyperlinkedRelatedField(required=False)
</code></pre>
<p>This is in line both with the rest of the serializer fields API, and with Django's <code>Form</code> and <code>ModelForm</code> API.</p>
<p>Using <code>required</code> throughout the serializers API means you won't need to consider if a particular field should take <code>blank</code> or <code>null</code> arguments instead of <code>required</code>, and also means there will be more consistent behavior for how fields are treated when they are not present in the incoming data.</p>
<p>The <code>null=True</code> argument will continue to function, and will imply <code>required=False</code>, but will raise a <code>PendingDeprecationWarning</code>.</p>
<h3 id="cleaner-charfield-syntax"><a class="toclink" href="#cleaner-charfield-syntax">Cleaner CharField syntax</a></h3>
<p>The <code>CharField</code> API previously took an optional <code>blank=True</code> argument, which was intended to differentiate between null CharField input, and blank CharField input.</p>
<p>In keeping with Django's CharField API, REST framework's <code>CharField</code> will only ever return the empty string, for missing or <code>None</code> inputs.  The <code>blank</code> flag will no longer be in use, and you should instead just use the <code>required=&lt;bool&gt;</code> flag.  For example:</p>
<pre><code>extra_details = CharField(required=False)
</code></pre>
<p>The <code>blank</code> keyword argument will continue to function, but will raise a <code>PendingDeprecationWarning</code>.</p>
<h3 id="simpler-object-level-permissions"><a class="toclink" href="#simpler-object-level-permissions">Simpler object-level permissions</a></h3>
<p>Custom permissions classes previously used the signature <code>.has_permission(self, request, view, obj=None)</code>.  This method would be called twice, firstly for the global permissions check, with the <code>obj</code> parameter set to <code>None</code>, and again for the object-level permissions check when appropriate, with the <code>obj</code> parameter set to the relevant model instance.</p>
<p>The global permissions check and object-level permissions check are now separated into two separate methods, which gives a cleaner, more obvious API.</p>
<ul>
<li>Global permission checks now use the <code>.has_permission(self, request, view)</code> signature.</li>
<li>Object-level permission checks use a new method <code>.has_object_permission(self, request, view, obj)</code>.</li>
</ul>
<p>For example, the following custom permission class:</p>
<pre><code>class IsOwner(permissions.BasePermission):
    """
    Custom permission to only allow owners of an object to view or edit it.
    Model instances are expected to include an `owner` attribute.
    """

    def has_permission(self, request, view, obj=None):
        if obj is None:
            # Ignore global permissions check
            return True

        return obj.owner == request.user
</code></pre>
<p>Now becomes:</p>
<pre><code>class IsOwner(permissions.BasePermission):
    """
    Custom permission to only allow owners of an object to view or edit it.
    Model instances are expected to include an `owner` attribute.
    """

    def has_object_permission(self, request, view, obj):
        return obj.owner == request.user
</code></pre>
<p>If you're overriding the <code>BasePermission</code> class, the old-style signature will continue to function, and will correctly handle both global and object-level permissions checks, but its use will raise a <code>PendingDeprecationWarning</code>.</p>
<p>Note also that the usage of the internal APIs for permission checking on the <code>View</code> class has been cleaned up slightly, and is now documented and subject to the deprecation policy in all future versions.</p>
<h3 id="more-explicit-hyperlink-relations-behavior"><a class="toclink" href="#more-explicit-hyperlink-relations-behavior">More explicit hyperlink relations behavior</a></h3>
<p>When using a serializer with a <code>HyperlinkedRelatedField</code> or <code>HyperlinkedIdentityField</code>, the hyperlinks would previously use absolute URLs if the serializer context included a <code>'request'</code> key, and fall back to using relative URLs otherwise.  This could lead to non-obvious behavior, as it might not be clear why some serializers generated absolute URLs, and others do not.</p>
<p>From version 2.2 onwards, serializers with hyperlinked relationships <em>always</em> require a <code>'request'</code> key to be supplied in the context dictionary.  The implicit behavior will continue to function, but its use will raise a <code>PendingDeprecationWarning</code>.</p></div>
        </div>

        <footer class="col-md-12">
            <hr>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>
            var base_url = "../..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../../js/base.js" defer></script>
        <script src="../../search/main.js" defer></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query" title="Type search term here">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
